Dealing with more malloc and free
